files:
  /config/dbconfig.sh:
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/usr/bin/env bash
      pwd 
      printenv
      # Using similar syntax as the appdeploy pre hooks that is managed by AWS
      echo "about to modify config.php with the following env variables $DBURL, $DBNAME, $DBUSER, password"
      sudo sed -ie "s/<DATABASEURL>/${DBURL}/" /config/config.php 
      sudo sed -ie "s/<DATABASENAME>/${DBNAME}/" /config/config.php
      sudo sed -ie "s/<DATABASEUSER>/${DBUSER}/" /config/config.php
      sudo sed -ie "s/<DATABASEPASSWORD>/${DBPASSWORD}/" /config/config.php
      sudo sed -ie "s/<WWWROOT>/${EBURL}/" /config/config.php

      echo "modified config.php"
container_commands:
  01_mount:
    command: "/config/dbconfig.sh"
